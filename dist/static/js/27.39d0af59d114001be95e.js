webpackJsonp([27],{IM03:function(e,t,s){var a=s("xKxB");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);s("XkoO")("1b3d8880",a,!0)},V4yq:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{staticClass:"diatable diasize",attrs:{visible:e.diaState,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,id:"diatable"},on:{"update:visible":function(t){e.diaState=t}}},[s("el-form",{ref:"temp",staticClass:"small-space dia_form",attrs:{model:e.temp,"label-position":"left","label-width":"160px"}},[s("p",[e._v("子组件")]),e._v(" "),s("el-form-item",{attrs:{label:"所属机构:",prop:"officeId"}},[s("el-select",{staticClass:"form_item",attrs:{disabled:e.selsctState,filterable:"",placeholder:"请选择"},model:{value:e.temp.officeId,callback:function(t){e.temp.officeId=t},expression:"temp.officeId"}},e._l(e.officeIds,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"岗位名称:",prop:"name"}},[s("el-input",{staticClass:"form_item",attrs:{placeholder:"请输入2-15位的岗位名称"},model:{value:e.temp.name,callback:function(t){e.temp.name="string"==typeof t?t.trim():t},expression:"temp.name"}})],1),e._v(" "),s("el-form-item",{staticClass:"treecss",attrs:{label:"权限:",prop:"check"}},[s("el-tree",{ref:"domTree",staticClass:"scrollBox form_item",attrs:{data:e.treeData,indent:30,"show-checkbox":"","node-key":"id","default-expand-all":!0,props:e.defaultProps},on:{"check-change":e.handTreechange,"node-click":e.nodeClick,"current-change":e.currentChange,"node-expand":e.nodeExpand,"node-collapse":e.nodeCollapse},model:{value:e.temp.check,callback:function(t){e.temp.check=t},expression:"temp.check"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",slot:"footer"},["update"==e.dialogStatus&&e.myselfUpdate?s("button",{staticClass:"button-large btn-color",attrs:{disabled:e.btnState},on:{click:function(t){e.update("temp")}}},[e._v("保 存")]):e._e(),e._v(" "),s("button",{staticClass:"button-large btn-color",attrs:{disabled:e.btnState},on:{click:function(t){e.create("temp")}}},[e._v("保 存")]),e._v(" "),s("button",{staticClass:"button-cancel btn-color-cancel",on:{click:function(t){e.resetForm("temp")}}},[e._v("取 消")])])],1)},i=[],n={render:a,staticRenderFns:i};t.a=n},Vc3t:function(e,t,s){"use strict";function a(){var e={};return c.a.get("sign")?e=JSON.parse(c.a.get("sign")):r.a.get("/apiservice/oss/getSign").then(function(t){var s=t.data;c.a.set("sign",n()(s)),e=JSON.parse(c.a.get("sign"))}),e}t.a=a;var i=s("3cXf"),n=s.n(i),r=s("Vo7i"),o=s("Z7nP"),c=s.n(o)},WWhx:function(e,t,s){"use strict";var a=s("Z7nP"),i=(s.n(a),s("oppB"));s("Vc3t");t.a={name:"role-dialog",data:function(){return{btnShow:JSON.parse(localStorage.getItem("btn")),btnState:!1,selsctState:!1,myselfUpdate:!0,officeIds:[],treeData:[],temp:{name:"",dataScope:"10",check:[],officeId:""},stationLv:[{id:"1",value:"一级"},{id:"2",value:"二级"},{id:"3",value:"三级"},{id:"4",value:"四级"},{id:"5",value:"五级"},{id:"6",value:"六级"},{id:"7",value:"七级"},{id:"8",value:"八级"},{id:"9",value:"九级"},{id:"10",value:"十级"}],roleLv:[],dialogStatus:"",textMap:{update:"编辑岗位",create:"新增岗位"},defaultProps:{children:"subMenus",label:"name"}}},computed:{},created:function(){var e=this;console.log(this.diaState,"111111222"),s.i(i.a)().then(function(t){e.treeData=t.data.data}),s.i(i.b)({}).then(function(t){e.officeIds=t.data.data.list})},props:["diaState"],methods:{nodeClick:function(e,t,s){},currentChange:function(e,t){},nodeExpand:function(e,t,s){},nodeCollapse:function(e,t,s){},handTreechange:function(e,t,s){if(t){if(["order_time","order_dispatch","order_addTech","order_cancel"].indexOf(e.permission)>-1)for(var a=e.parentIds.split(","),i=0;i<this.treeData.length;i++)if(void 0!=this.treeData[i].subMenus)for(var n=0;n<this.treeData[i].subMenus.length;n++)"order"==this.treeData[i].subMenus[n].permission&&this.$refs.domTree.setChecked(this.treeData[i].subMenus[n].subMenus[this.treeData[i].subMenus[n].subMenus.length-2].id,!0);if(void 0==e.subMenus)for(var a=e.parentIds.split(","),i=0;i<this.treeData.length;i++)if(void 0!=this.treeData[i].subMenus)for(var n=0;n<this.treeData[i].subMenus.length;n++)if(this.treeData[i].subMenus[n].id==a[3]){var r=this.treeData[i].subMenus[n].subMenus[this.treeData[i].subMenus[n].subMenus.length-1];if(void 0!=r.permission){var o=r.permission,c=o.substring(o.length-4,o.length);"view"==c&&this.$refs.domTree.setChecked(r.id,!0)}}}else{if("order_info"==e.permission)for(var i=0;i<this.treeData.length;i++)if(void 0!=this.treeData[i].subMenus)for(var n=0;n<this.treeData[i].subMenus.length;n++)if("order"==this.treeData[i].subMenus[n].permission)for(var l=this.treeData[i].subMenus[n],u=0;u<l.subMenus.length-2;u++)this.temp.check.indexOf(l.subMenus[u].id)>-1&&(this.$refs.domTree.setChecked(this.treeData[i].subMenus[n].subMenus[l.subMenus.length-2].id,!0),this.temp.check=this.$refs.domTree.getCheckedKeys());if("view"==e.permission.substring(e.permission.length-4,e.permission.length))for(var d=e.parentIds.split(","),i=0;i<this.treeData.length;i++)if(void 0!=this.treeData[i].subMenus)for(var n=0;n<this.treeData[i].subMenus.length;n++)if(this.treeData[i].subMenus[n].id==d[3])for(var u=0;u<this.treeData[i].subMenus[n].subMenus.length-1;u++)this.temp.check.indexOf(this.treeData[i].subMenus[n].subMenus[u].id)>-1&&this.$refs.domTree.setChecked(this.treeData[i].subMenus[n].subMenus[this.treeData[i].subMenus[n].subMenus.length-1].id,!0)}this.temp.check=this.$refs.domTree.getCheckedKeys()},create:function(e){for(var t=this,a=this.$refs.domTree.getCheckedKeys(),n="",r=0;r<a.length;r++)n+=a[r]+",";var o={name:this.temp.name,dataScope:"10",menuIds:n,useable:"1",organization:{id:this.temp.officeId}};this.$refs[e].validate(function(a){if(!a){for(var n=t.$refs[e]._data.fields,r=[],c=0;c<n.length;c++)""!=n[c].validateMessage&&r.push(n[c].validateMessage);return t.$message({type:"error",message:r[0]}),!1}t.btnState=!0,s.i(i.l)(o).then(function(s){t.btnState=!1,1===s.data.code&&(t.resetTemp(),t.$refs[e].resetFields(),t.$refs.domTree.setCheckedKeys([]),t.$message({type:"success",message:"添加成功"}),t.diaState=!1)}).catch(function(e){t.btnState=!1})})},resetTemp:function(){this.temp={officeId:"",name:"",dataScope:"10",check:[]}},resetForm:function(){this.$emit("diaState",!1)}}}},oppB:function(e,t,s){"use strict";function a(e){return k.a.post("/apiservice/a/sys/user/saveData",e)}function i(e){return k.a.post("/apiservice/a/sys/user/upData",e)}function n(e){return k.a.post("/apiservice/a/sys/user/formData",e)}function r(e,t,s){return k.a.post("/apiservice/a/sys/role/listPageData?pageNo="+t+"&pageSize="+s,e)}function o(e){return k.a.post("/apiservice/a/sys/role/listDataWithoutPermission",e)}function c(e,t,s){return k.a.post("/apiservice/a/sys/user/listData?pageNo="+t+"&pageSize="+s,e)}function l(e){return k.a.post("/apiservice/a/sys/role/saveData",e)}function u(e){return k.a.post("/apiservice/a/sys/role/upData",e)}function d(e){return k.a.post("/apiservice/a/sys/role/deleteRole",e)}function f(e){return k.a.get("/apiservice/a/sys/role/getRoleDetail?id="+e)}function p(e){return k.a.post("/apiservice/a/sys/organization/getOrgByTypeOrgId",e)}function h(e){return k.a.post("/apiservice/a/service/station/serviceStation/listStationByOrgId",e)}function m(e){return k.a.post("/apiservice/a/sys/organization/listDataAll",e)}function v(e){return k.a.post("/apiservice/a/service/station/serviceStation/listByOffice",e)}function g(){return k.a.get("/apiservice/a/sys/menu/getMenuList")}function b(e){return k.a.post("/apiservice/a/sys/user/deleteUser",e)}function M(e){return k.a.get("/apiservice/a/sys/role/chkName?id="+e.id+"&name="+e.name)}function D(e){return k.a.get("/apiservice/a/sys/role/chkNameUpdate?id="+e.id+"&name="+e.name+"&roleId="+e.roleId)}t.k=a,t.m=i,t.g=n,t.o=r,t.j=o,t.e=c,t.l=l,t.r=u,t.q=d,t.p=f,t.f=p,t.i=h,t.b=m,t.c=v,t.a=g,t.h=b,t.d=M,t.n=D;var k=s("Vo7i")},xKxB:function(e,t,s){t=e.exports=s("acE3")(!1),t.push([e.i,".treecss .el-tree-node .el-tree-node__children .el-tree-node .el-tree-node__children .el-tree-node__children .el-tree-node,.treecss .el-tree-node .el-tree-node__children .el-tree-node__children .el-tree-node{float:left}.ceshi{height:25px;width:80px}.dialog-footer{text-align:center}.scrollBox{height:400px;overflow-y:scroll;overflow-x:hidden}.diasize .el-dialog{width:60%}",""])},zfsD:function(e,t,s){"use strict";function a(e){s("IM03")}Object.defineProperty(t,"__esModule",{value:!0});var i=s("WWhx"),n=s("V4yq"),r=s("J0+h"),o=a,c=r(i.a,n.a,o,null,null);t.default=c.exports}});